---
output: 
  pagedown::html_paged:
    css: www/styles_weeklyQC.css
    toc: false
    numbered_sections: false
---

```{r standdata, include = FALSE}
stand_plot <- left_join(plotevs, stand, 
                        by = c("Plot_Name", "IsStuntedWoodland", "SampleYear", "cycle")) |> 
  filter(Plot_Name %in% params$plot)

stand_tab1 <- kable(stand_plot |> select(Orientation, Aspect, PhysiographyCode, PhysiographySummary, PhysiographyLabel,
                                         IsStuntedWoodland, xCoordinate, yCoordinate),
                    col.names = c("Orientation", "Aspect", "Physio. Code", "Physio. Class",
                                  "Physio. Detail", "Stunted Woodland", "X", "Y"),
                    format = 'html', align = 'c') |> 
              kable_styling(fixed_thead = TRUE, full_width = TRUE, position = 'left') |> 
              row_spec(0, extra_css = 'border-bottom: 1px solid #000000')
            

stand_tab2 <- kable(stand_plot |> select(Txt_Crown_Closure, Stand_Structure, Deer_Browse_Index,
                                         Water_on_Plot_Code, Microtopography, Earthworms), 
                    format = "html", align = 'c',
                    col.names = c("Crown Closure", "Stand Structure", "Deer Browse Index", 
                                  "Water on Plot", "Microtopography", "Earthworms")) |> 
              kable_styling(fixed_thead = TRUE, full_width = TRUE, position = 'left')|> 
              row_spec(0, extra_css = 'border-bottom: 1px solid #000000')

stand_tab3 <- kable(stand_plot |> select(Txt_Bare_Soil, Txt_Rock, Txt_Trampled, Txt_Water, 
                                         Txt_Bryophyte, Txt_Lichen, 
                                         Txt_Understory_Low, Txt_Understory_Mid, Txt_Understory_High),
                    col.names = c("% Bare Soil", "% Rock", "% Trampled", "% Surface Water", 
                                  "% Non-Vascular", "% Lichen",
                                  "% Vasc. Low", "% Vasc. Mid", "% Vasc. High"),
                    align = 'c') |> 
              kable_styling(fixed_thead = TRUE, full_width = TRUE, position = 'left')|> 
              row_spec(0, extra_css = 'border-bottom: 1px solid #000000')

treeht_p <- treeht |> filter(Plot_Name %in% params$plot)

treeht_tab <- kable(treeht_p |> select(CrownClassLabel, TagCode, Height), align = 'c', format = 'html',
                    col.names = c("Crown Class", "Tag", "Height")) |> 
              kable_styling(fixed_thead = TRUE, full_width = TRUE, position = 'left') |> 
              collapse_rows(1, valign = 'top') |> 
              row_spec(0, extra_css = 'border-bottom: 1px solid #000000')


```

```{r treesum, include = F}
tree_sump <- tree_sum |> filter(Plot_Name %in% params$plot) 

tree_sump_w <- tree_sump |> pivot_wider(names_from = "Status", 
                                        values_from = "num_stems", 
                                        values_fill = 0) |> 
  select(-Plot_Name)

tots <- c("Totals", colSums(tree_sump_w[,-1]))

tree_sump_w2 <- rbind(tree_sump_w, tots)

cols <- c("Species", names(tree_sump_w2[2:ncol(tree_sump_w2)]))

tree_sum_tab <- kable(tree_sump_w2,
                      col.names = cols,
                      format = 'html', align = 'c') |> 
                kable_styling(fixed_thead = TRUE, position = 'left', full_width = TRUE) |> 
                row_spec(nrow(tree_sump_w2), bold = T)

```


#### Plot Data
```{r standtab1, echo = F}
stand_tab1
```


#### Stand Data
```{r standtab2, echo = F}
stand_tab2
```

#### Site Cover
```{r standtab3, echo = F}
stand_tab3
```

<div class = "column40">
#### Tree Height
```{r standtab4, echo = F}
treeht_tab
```
</div>

<div class = "column60">

#### Number of Trees by Status 

```{r treesum_tab}
tree_sum_tab
```
</div>

